<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Anime Timer Bot</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div class="container">
        
        <div id="screen-menu" class="screen active">
            <h1>üé¨ –ó–∞–º–µ—Ç–∫–∏ –æ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–Ω–æ–º</h1>
            <button class="btn" onclick="app.toNewView()">–ù–æ–≤—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä</button>
            <button class="btn btn-outline" onclick="app.toggleHistory()">–°–ø–∏—Å–æ–∫ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–Ω–æ–≥–æ</button>
            <button class="btn btn-outline" onclick="app.toEditMode()">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
        </div>

        <div id="screen-player" class="screen">
            <input type="text" id="media-title" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ (–•–æ–¥—è—á–∏–π –∑–∞–º–æ–∫, –ê–≤–∞—Ç–∞—Ä...)">
            
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                <button class="btn-small btn-outline" onclick="app.addEpisode()" style="margin-left: auto;">+ –≠–ø–∏–∑–æ–¥</button>
            </div>

            <div id="episode-section" class="episode-section">
                <span style="color: var(--text-sec); font-size: 12px;">–°–µ—Ä–∏–∏ / –ì–ª–∞–≤—ã</span>
                <div class="episode-chips" id="episode-list">
                    </div>
            </div>

            <div class="timer-display" id="timer">00:00:00</div>
            
            <div class="timer-controls">
                <button class="btn btn-small" id="btn-timer-toggle">‚ñ∂ –°—Ç–∞—Ä—Ç</button>
                <button class="btn btn-small btn-outline" id="btn-timer-reset">‚Ü∫ –°–±—Ä–æ—Å</button>
                <button class="btn btn-small btn-outline" id="btn-timer-edit">‚úé –í—Ä–µ–º—è</button>
            </div>

            <hr style="border-color: #333;">

            <div id="player-timeline" class="mini-timeline-container">
                </div>

            <button class="btn" onclick="app.openEditor()">üìù –ù–æ–≤–∞—è –º–µ—Ç–∫–∞ —Ç—É—Ç</button>
            <button class="btn btn-outline" onclick="app.openQuickTagMenu()">‚ö° –ë—ã—Å—Ç—Ä–∞—è –º–µ—Ç–∫–∞ —Ç—É—Ç</button>

            <!-- –ú–∏–Ω–∏-–º–µ–Ω—é –±—ã—Å—Ç—Ä—ã—Ö –º–µ—Ç–æ–∫ -->
            <div id="quick-tag-menu" class="modal-overlay" style="display:none;">
                <div class="modal-content" style="max-width:300px; text-align:center;">
                    <h3>–ë—ã—Å—Ç—Ä–∞—è –º–µ—Ç–∫–∞</h3>

                    <button class="btn" onclick="app.addQuickTag('—Ç—É—Ç –∫—Ä–∞—Å–∏–≤—ã–π –∫–∞–¥—Ä')">–ö—Ä–∞—Å–∏–≤—ã–π –∫–∞–¥—Ä</button>
                    <button class="btn" onclick="app.addQuickTag('—Ç—É—Ç –∏–Ω—Ç–µ—Ä–µ—Å–Ω–∞—è –º—ã—Å–ª—å')">–ò–Ω—Ç–µ—Ä–µ—Å–Ω–∞—è –º—ã—Å–ª—å</button>
                    <button class="btn" onclick="app.addQuickTag('—Ç—É—Ç –∏–Ω—Ç–µ—Ä–µ—Å–Ω–∞—è –º—É–∑—ã–∫–∞')">–ú—É–∑—ã–∫–∞</button>
                    <button class="btn" onclick="app.addQuickTag('—Ç—É—Ç —á—Ç–æ-—Ç–æ –¥—Ä—É–≥–æ–µ')">–î—Ä—É–≥–æ–µ</button>

                    <button class="btn btn-danger" onclick="app.closeQuickTagMenu()">–û—Ç–º–µ–Ω–∞</button>
                </div>
            </div>

            <button class="btn btn-danger" onclick="app.toMenu()">–í –º–µ–Ω—é(—Å–æ—Ö—Ä–∞–Ω–∏—Ç—å)</button>
        </div>

        <div id="screen-list" class="screen">
            <div class="header-nav">
                <button class="btn-icon" onclick="app.toMenu()">‚Üê</button>
                <h2 id="list-title">–ú–æ–∏ –ø—Ä–æ—Å–º–æ—Ç—Ä—ã</h2>
            </div>
            <div id="list-container" class="list-wrapper"></div>
        </div>

        <div id="screen-view" class="screen">
            <div class="header-nav">
                <button class="btn-icon" onclick="historyApp.backToList()">‚Üê</button>
                <h3 id="view-title">–ù–∞–∑–≤–∞–Ω–∏–µ</h3>
            </div>
            
            <div id="view-episodes" class="episode-chips horizontal-scroll"></div>

            <div id="view-timeline" class="view-timeline-container"></div>
            
            <div id="edit-controls" class="edit-bottom-bar" style="display:none;">
                <label><input type="checkbox" id="select-all-checkbox"> –í—Å–µ</label>
                <button class="btn btn-danger btn-small" onclick="historyApp.deleteSelected()">–£–¥–∞–ª–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω–æ–µ</button>
            </div>

            <button class="btn" style="margin-top: 20px;" onclick="app.continueWatchingFromHistory()">‚ñ∂ –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –ø—Ä–æ—Å–º–æ—Ç—Ä</button>
        </div>

        <div id="media-modal" class="modal-overlay" style="display: none;">
            <div class="modal-content">
                <button class="modal-close" onclick="historyApp.closeModal()">√ó</button>
                <div id="modal-body">
                    </div>
                <div id="modal-nav" class="modal-nav">
                    <button onclick="historyApp.prevSlide()">‚ùÆ</button>
                    <span id="slide-counter">1/1</span>
                    <button onclick="historyApp.nextSlide()">‚ùØ</button>
                </div>
            </div>
        </div>

        <div id="screen-editor" class="screen">
            <h3 style="display:flex; justify-content:space-between; align-items:center;">
                <span>
                    –ó–∞–º–µ—Ç–∫–∞ –Ω–∞ <span id="editor-timestamp">00:00:00</span>
                    <span id="editor-timer-live" style="color:#aaa; font-size:14px; margin-left:4px; display:none;">
                        (—Ç–µ–∫—É—â–∏–π: 00:00:00)
                    </span>
                </span>

                <button id="editor-timer-pause" class="btn-small btn-outline" 
                        style="display:none; padding:3px 6px; font-size:12px;">
                    ‚è∏
                </button>
            </h3>
            
            <div class="toolbar">
                <button data-command="bold"><b>B</b></button>
                <button data-command="italic"><i>I</i></button>
                <button data-command="formatBlock" data-arg="blockquote">‚Äù</button>
            </div>
            
            <div class="editor-area" id="note-text" contenteditable="true"></div>

            <div style="margin-top: 10px;">
                <label class="btn btn-small btn-outline" style="display:inline-block; width:auto;">
                    üì∑ –î–æ–±–∞–≤–∏—Ç—å —Ñ–æ—Ç–æ
                    <input type="file" id="file-input" accept="image/*" multiple hidden onchange="app.handleFiles(this)">
                </label>
                <div id="preview-container"></div>
            </div>

            <div style="margin-top: 20px;">
                <button class="btn" onclick="app.saveNote()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                <button class="btn btn-outline" onclick="app.cancelEditor()">–û—Ç–º–µ–Ω–∞</button>
            </div>
        </div>

        <div id="screen-history" class="screen">
            </div>

    </div>

    <script type="module" src="app.js"></script>
    <div id="save-status" class="save-status hidden"></div>
</body>
</html>